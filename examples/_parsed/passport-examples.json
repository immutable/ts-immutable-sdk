{
  "logged-in-user-with-nextjs": {
    "tutorial": "# Logged-in User with NextJS Example\n\n## Introduction\nThis example app demonstrates how to access user information and tokens after a user has logged in via Passport in a NextJS application. It showcases several useful Passport SDK features for retrieving user identity information, linked addresses, and tokens for verification. This example highlights how to integrate Passport authentication within a NextJS application and access various user details after successful authentication.\n\n[View the example app on GitHub](https://github.com/immutable/ts-immutable-sdk/tree/main/examples/passport/logged-in-user-with-nextjs)\n\n## Features Overview\n- Retrieving user profile information after login\n- Getting linked addresses associated with a user's account\n- Retrieving ID and access tokens for verification purposes\n- Implementing OAuth redirect flow in NextJS\n\n## SDK Integration Details\n\n### Get User Information\n**Link:** [User Info Component](https://github.com/immutable/ts-immutable-sdk/blob/main/examples/passport/logged-in-user-with-nextjs/src/app/user-info-with-passport/page.tsx)\n\n**Feature Name:** Retrieving User Profile Information\n\n**Implementation:**\n```typescript\nconst userProfileData = await passportInstance.getUserInfo();\n```\n\n**Explanation:**\nAfter a user successfully logs in with Passport, you can use the `getUserInfo()` method to retrieve the user's profile information. This method returns an object containing details such as email, nickname, and the subject identifier (sub). This information can be used to personalize the user experience within your application. The example displays this information in a table after the user logs in.\n\n### Get Linked Addresses\n**Link:** [Linked Addresses Component](https://github.com/immutable/ts-immutable-sdk/blob/main/examples/passport/logged-in-user-with-nextjs/src/app/linked-addresses-with-passport/page.tsx)\n\n**Feature Name:** Retrieving Linked Addresses\n\n**Implementation:**\n```typescript\nconst addresses = await passportInstance.getLinkedAddresses();\n```\n\n**Explanation:**\nThe `getLinkedAddresses()` method fetches all blockchain addresses linked to the user's Passport account. This is particularly useful for applications that need to interact with multiple chains or need to know all of a user's connected wallets. The example retrieves and displays these linked addresses after the user authenticates.\n\n### Get ID and Access Tokens\n**Link:** [Verify Tokens Component](https://github.com/immutable/ts-immutable-sdk/blob/main/examples/passport/logged-in-user-with-nextjs/src/app/verify-tokens-with-nextjs/page.tsx)\n\n**Feature Name:** Retrieving Authentication Tokens\n\n**Implementation:**\n```typescript\nconst idToken = await passportInstance.getIdToken();\nconst accessToken = await passportInstance.getAccessToken();\n```\n\n**Explanation:**\nThe Passport SDK provides methods to retrieve the ID token and access token after a user has logged in. The ID token contains claims about the user's identity, while the access token is used to authenticate requests to protected resources. These tokens can be used for server-side verification or for making authenticated requests to Immutable APIs. The example shows how to retrieve and display these tokens.\n\n### OAuth Redirect Flow\n**Link:** [Redirect Component](https://github.com/immutable/ts-immutable-sdk/blob/main/examples/passport/logged-in-user-with-nextjs/src/app/redirect/page.tsx)\n\n**Feature Name:** Handling OAuth Redirect\n\n**Implementation:**\n```typescript\nuseEffect(() => {\n  if (passportInstance) {\n    passportInstance.loginCallback()\n      .then(() => {\n        console.log('Login callback successful');\n        if (window.opener) {\n          window.opener.postMessage('authComplete', window.origin);\n          window.close();\n        }\n      })\n      .catch((error) => {\n        console.error('Error in login callback:', error);\n      });\n  }\n}, []);\n```\n\n**Explanation:**\nThe redirect component handles the OAuth callback after a user authenticates with Passport. It uses the `loginCallback()` method to process the authentication response and complete the login flow. This is a crucial part of the OAuth 2.0 authentication flow, where the authorization server redirects back to your application with an authorization code. The example shows how to implement this in a NextJS application, including how to handle the case when the login happens in a popup window.\n\n## Running the App\n\n[View the example app on GitHub](https://github.com/immutable/ts-immutable-sdk/tree/main/examples/passport/logged-in-user-with-nextjs)\n\n### Prerequisites\n- Node.js 16 or higher\n- pnpm\n- An Immutable Hub account to obtain required API keys\n  - [Sign up for Immutable Hub](https://hub.immutable.com/)\n\n### Setup Instructions\n1. Clone the repository:\n   ```bash\n   git clone https://github.com/immutable/ts-immutable-sdk.git\n   cd ts-immutable-sdk/examples/passport/logged-in-user-with-nextjs\n   ```\n\n2. Install dependencies:\n   ```bash\n   pnpm install\n   ```\n\n3. Create a `.env` file from the example:\n   ```bash\n   cp .env.example .env\n   ```\n\n4. Add your Immutable Hub API keys to the `.env` file:\n   ```\n   NEXT_PUBLIC_PUBLISHABLE_KEY=your_publishable_key\n   NEXT_PUBLIC_CLIENT_ID=your_client_id\n   ```\n\n5. Start the development server:\n   ```bash\n   pnpm dev\n   ```\n\n6. Open [http://localhost:3000](http://localhost:3000) in your browser to use the app.\n\n## Summary\nThis example demonstrates various methods to access user information after a successful login with Passport in a NextJS application. It showcases how to retrieve user profile information, linked addresses, and authentication tokens, providing a comprehensive implementation of post-authentication features. These features are essential for applications that need to interact with authenticated users and utilize their identity information for personalized experiences or blockchain transactions.\n\nBy following this example, developers can understand how to properly integrate Passport authentication in their NextJS applications and access user information in a secure and efficient manner. ",
    "metadata": {
      "title": "Logged-in User with NextJS",
      "description": "A NextJS example app demonstrating how to access user information, linked addresses, and tokens after logging in with Passport SDK",
      "keywords": [
        "Immutable",
        "SDK",
        "Passport",
        "NextJS",
        "Authentication",
        "User Profile",
        "Linked Addresses",
        "Tokens",
        "OAuth"
      ],
      "tech_stack": [
        "NextJS",
        "React",
        "TypeScript",
        "Biome UI"
      ],
      "product": "Passport",
      "programming_language": "TypeScript"
    }
  }
}