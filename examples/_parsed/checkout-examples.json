{
  "commerce-widget-nextjs": {
    "tutorial": "# Commerce Widget with Next.js Tutorial\n\n## Introduction\n\nThis example app demonstrates how to implement the Immutable Checkout SDK's Commerce Widget in a Next.js application. The Commerce Widget provides a pre-built UI component that enables users to connect wallets and interact with blockchain features in your application. This example focuses on mounting the widget, configuring it for wallet connection, and handling widget events.\n\nThe example is built using Next.js and Immutable's SDK to provide a clean, developer-friendly implementation of the Commerce Widget flow.\n\n[GitHub Repository](https://github.com/immutable/ts-immutable-sdk/tree/main/examples/checkout/commerce-widget-nextjs)\n\n## Features Overview\n\n- **Commerce Widget Integration**: Demonstrates how to mount and use the Commerce Widget from the Checkout SDK\n- **Event Handling**: Shows how to listen for and respond to widget events (SUCCESS, FAILURE, CLOSE)\n- **Wallet Connection Flow**: Implements the wallet connection flow using the Commerce Widget\n- **UI Integration**: Integrates the widget into a responsive Next.js application with Biom3 design components\n\n## SDK Integration Details\n\n### Widget Initialization and Mounting\n\n**Link**: [widgets/page.tsx](https://github.com/immutable/ts-immutable-sdk/blob/main/examples/checkout/commerce-widget-nextjs/src/app/widgets/page.tsx)\n\n**Feature Name**: Widget Initialization\n\n**Implementation**:\n```typescript\nconst checkoutSDK = new checkout.Checkout();\n\nfunction Widgets() {\n  const [widget, setWidget] = useState<Widget<WidgetType.IMMUTABLE_COMMERCE>>();\n\n  useEffect(() => {\n    const loadWidgets = async () => {\n      const widgetsFactory = await checkoutSDK.widgets({ config: {} });\n      const widget = widgetsFactory.create(WidgetType.IMMUTABLE_COMMERCE, {})\n      setWidget(widget);\n    }\n\n    loadWidgets();\n  }, []);\n\n  useEffect(() => {\n    if (!widget) return;\n    widget.mount(\"widget-root\", {\n      flow: CommerceFlowType.WALLET,\n    });\n    \n    // Event listeners...\n  }, [widget]);\n}\n```\n\n**Explanation**: \nThe code initializes the Checkout SDK and creates a Commerce Widget. Within a React useEffect hook, the widget is created using the `widgetsFactory.create()` method with the `WidgetType.IMMUTABLE_COMMERCE` type. Once the widget is created and stored in state, a second useEffect hook mounts the widget to a DOM element with the ID \"widget-root\" and configures it to use the WALLET flow type.\n\n### Event Handling\n\n**Link**: [widgets/page.tsx](https://github.com/immutable/ts-immutable-sdk/blob/main/examples/checkout/commerce-widget-nextjs/src/app/widgets/page.tsx)\n\n**Feature Name**: Widget Event Listeners\n\n**Implementation**:\n```typescript\n// Success event handling\nwidget.addListener(\n  checkout.CommerceEventType.SUCCESS,\n  (payload: checkout.CommerceSuccessEvent) => {\n    const { type, data } = payload;\n\n    // capture provider after user connects their wallet\n    if (type === checkout.CommerceSuccessEventType.CONNECT_SUCCESS) {\n      const { walletProviderName } = data as ConnectionSuccess;\n      console.log('connected to ', walletProviderName);\n      // setProvider(data.provider);\n\n      // optional, immediately close the widget\n      // widget.unmount();\n    }\n  }\n);\n\n// Failure event handling\nwidget.addListener(\n  checkout.CommerceEventType.FAILURE,\n  (payload: checkout.CommerceFailureEvent) => {\n    const { type, data } = payload;\n\n    if (type === checkout.CommerceFailureEventType.CONNECT_FAILED) {\n      console.log('failed to connect', data.reason);\n    }\n  }\n);\n\n// Close event handling\nwidget.addListener(checkout.CommerceEventType.CLOSE, () => {\n  widget.unmount();\n});\n\n// Clean up event listeners\nreturn () => {\n  widget.removeListener(checkout.CommerceEventType.SUCCESS);\n  widget.removeListener(checkout.CommerceEventType.DISCONNECTED);\n  widget.removeListener(checkout.CommerceEventType.CLOSE);\n};\n```\n\n**Explanation**:\nThe code adds event listeners to the Commerce Widget to handle different scenarios:\n1. SUCCESS events: Captures successful connections, logging the wallet provider name and allowing for optional widget unmounting\n2. FAILURE events: Handles connection failures and logs the reason\n3. CLOSE events: Automatically unmounts the widget when closed\n\nThe code also includes proper cleanup of event listeners when the component unmounts.\n\n### Custom Configuration Setup\n\n**Link**: [utils/setupCustom.ts](https://github.com/immutable/ts-immutable-sdk/blob/main/examples/checkout/commerce-widget-nextjs/src/app/utils/setupCustom.ts)\n\n**Feature Name**: Custom SDK Configuration\n\n**Implementation**:\n```typescript\nimport { checkout, config } from '@imtbl/sdk';\n\n// Replace with your Publishable Key from the Immutable Hub\nconst PUBLISHABLE_KEY = process.env.NEXT_PUBLIC_PUBLISHABLE_KEY ?? '' \n\n// Set the environment to SANDBOX for testnet or PRODUCTION for mainnet\nconst baseConfig = {\n  environment: config.Environment.SANDBOX,\n  publishableKey: PUBLISHABLE_KEY,\n};\n\n// Instantiate the Checkout SDKs with the default configurations\nexport const checkoutSDK = new checkout.Checkout({\n  baseConfig,\n  bridge: { enable: true },\n  onRamp: { enable: true },\n  swap: { enable: true },\n  // passport: <optionally add Passport instance>\n});\n```\n\n**Explanation**:\nThis utility demonstrates how to create a custom configuration for the Checkout SDK. It sets up a base configuration with the environment (SANDBOX for testnet) and a publishable key from environment variables. It then initializes the Checkout SDK with additional features enabled, including bridge, onRamp, and swap functionalities.\n\n## Running the App\n\n[GitHub Repository](https://github.com/immutable/ts-immutable-sdk/tree/main/examples/checkout/commerce-widget-nextjs)\n\n### Prerequisites\n\n* Node.js 18 or higher\n* pnpm package manager\n* An [Immutable Hub](https://hub.immutable.com/) account for generating your publishable API key\n\n### Setup Instructions\n\n1. Clone the repository and navigate to the example directory:\n   ```\n   git clone https://github.com/immutable/ts-immutable-sdk.git\n   cd ts-immutable-sdk/examples/checkout/commerce-widget-nextjs\n   ```\n\n2. Install dependencies:\n   ```\n   pnpm install\n   ```\n\n3. Create an environment variables file:\n   ```\n   cp .env.example .env\n   ```\n\n4. Add your Publishable API Key from Immutable Hub to the `.env` file:\n   ```\n   NEXT_PUBLIC_PUBLISHABLE_KEY=your_publishable_key_here\n   ```\n\n5. Start the development server:\n   ```\n   pnpm dev\n   ```\n\n6. Open your browser and navigate to http://localhost:3000\n\n### Testing\n\nThe app includes E2E tests for the Commerce Widget:\n\n1. Build the app:\n   ```\n   pnpm build\n   ```\n\n2. Run tests using remote widgets:\n   ```\n   pnpm test:remotewidgets\n   ```\n\n## Summary\n\nThis example app demonstrates how to integrate the Immutable Checkout SDK's Commerce Widget into a Next.js application, focusing on:\n\n- Initializing and mounting the Commerce Widget\n- Configuring the widget for wallet connections\n- Handling widget events (success, failure, close)\n- Setting up custom SDK configurations\n\nBy following this example, developers can easily add wallet connection capabilities to their applications using Immutable's pre-built Commerce Widget, which provides a seamless user experience while reducing development effort. ",
    "metadata": {
      "title": "Commerce Widget Integration with Next.js",
      "description": "A Next.js example that demonstrates how to integrate, mount, and handle events from the Immutable Checkout SDK's Commerce Widget for wallet connection flows.",
      "keywords": [
        "Immutable",
        "SDK",
        "Commerce Widget",
        "Checkout SDK",
        "Next.js",
        "Wallet Connection",
        "Widget Integration",
        "Event Handling"
      ],
      "tech_stack": [
        "Next.js",
        "React",
        "TypeScript",
        "Biom3 UI",
        "Immutable SDK"
      ],
      "product": "Checkout",
      "programming_language": "TypeScript"
    }
  }
}